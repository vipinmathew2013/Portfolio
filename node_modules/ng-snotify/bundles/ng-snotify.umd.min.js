!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("ng-snotify",["exports","@angular/core","rxjs","@angular/common"],n):n((t=t||self)["ng-snotify"]={},t.ng.core,t.rxjs,t.ng.common)}(this,(function(t,n,o,e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var i,s=function(){return(s=Object.assign||function(t){for(var n,o=1,e=arguments.length;o<e;o++)for(var i in n=arguments[o])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)};function r(t,n,o,e){var i,s=arguments.length,r=s<3?n:null===e?e=Object.getOwnPropertyDescriptor(n,o):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,n,o,e);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(s<3?i(r):s>3?i(n,o,r):i(n,o))||r);return s>3&&r&&Object.defineProperty(n,o,r),r}function a(n,o,e){return o===t.SnotifyStyle.async?{value:function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return t=2===n.length?{title:null,body:n[0],config:null,action:n[1]}:3===n.length?"string"==typeof n[1]?{title:n[1],body:n[0],config:null,action:n[2]}:{title:null,body:n[0],config:n[2],action:n[1]}:{title:n[1],body:n[0],config:n[3],action:n[2]},e.value.apply(this,[t])}}:{value:function(){for(var t,n,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return 1===o.length?n={title:null,body:o[0],config:null}:3===o.length?n={title:o[1],body:o[0],config:o[2]}:((t={title:null,config:null,body:o[0]})["string"==typeof o[1]?"title":"config"]=o[1],n=t),e.value.apply(this,[n])}}}function c(t){return t&&"object"==typeof t&&!Array.isArray(t)}function f(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var e={};if(!n.length)return e;for(;n.length>0;){var i=n.shift();if(c(i))for(var s in i)c(i[s])?e[s]=f(e[s],i[s]):Object.assign(e,((t={})[s]=i[s],t))}return e}function u(t,n,o){return{value:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t[0].config=s(s({},t[0].config),{type:n}),o.value.apply(this,t)}}}(i=t.SnotifyStyle||(t.SnotifyStyle={})).simple="simple",i.success="success",i.error="error",i.warning="warning",i.info="info",i.async="async",i.confirm="confirm",i.prompt="prompt";var l,p=function(){function n(n,e,i,s){var r=this;this.id=n,this.title=e,this.body=i,this.config=s,this.eventEmitter=new o.Subject,this.eventsHolder=[],this.config.type===t.SnotifyStyle.prompt&&(this.value=""),this.on("hidden",(function(){r.eventsHolder.forEach((function(t){t.unsubscribe()}))}))}return n.prototype.on=function(t,n){var o=this;return this.eventsHolder.push(this.eventEmitter.subscribe((function(e){e===t&&n(o)}))),this},n.prototype.equals=function(t){return this.body===t.body&&this.title===t.title&&this.config.type===t.config.type},n}(),y=function(){function e(t){this.config=t,this.emitter=new o.Subject,this.toastChanged=new o.Subject,this.toastDeleted=new o.Subject,this.notifications=[]}var i,c;return e.prototype.emit=function(){this.emitter.next(this.notifications.slice())},e.prototype.get=function(t){return this.notifications.find((function(n){return n.id===t}))},e.prototype.add=function(t){this.config.global.filterDuplicates&&this.containsToast(t)||(this.config.global.newOnTop?this.notifications.unshift(t):this.notifications.push(t),this.emit())},e.prototype.containsToast=function(t){return this.notifications.some((function(n){return n.equals(t)}))},e.prototype.remove=function(t,n){return t?n?(this.notifications=this.notifications.filter((function(n){return n.id!==t})),this.emit()):void this.toastDeleted.next(t):this.clear()},e.prototype.clear=function(){this.notifications=[],this.emit()},e.prototype.create=function(t){var n=f(this.config.toast,this.config.type[t.config.type],t.config),o=new p(Math.floor(Math.random()*(Date.now()-1))+1,t.title,t.body,n);return this.add(o),o},e.prototype.setDefaults=function(t){return this.config=f(this.config,t)},e.prototype.simple=function(t){return this.create(t)},e.prototype.success=function(t){return this.create(t)},e.prototype.error=function(t){return this.create(t)},e.prototype.info=function(t){return this.create(t)},e.prototype.warning=function(t){return this.create(t)},e.prototype.confirm=function(t){return this.create(t)},e.prototype.prompt=function(t){return this.create(t)},e.prototype.async=function(n){var e,i=this;e=n.action instanceof Promise?o.from(n.action):n.action;var s=this.create(n);return s.on("mounted",(function(){var n=e.subscribe((function(t){i.mergeToast(s,t)}),(function(o){i.mergeToast(s,o,t.SnotifyStyle.error),n.unsubscribe()}),(function(){i.mergeToast(s,{},t.SnotifyStyle.success),n.unsubscribe()}))})),s},e.prototype.mergeToast=function(t,n,o){n.body&&(t.body=n.body),n.title&&(t.title=n.title),t.config=o?f(t.config,this.config.global,this.config.toast[o],{type:o},n.config):f(t.config,n.config),n.html&&(t.config.html=n.html),this.emit(),this.toastChanged.next(t)},e.prototype.html=function(t,n){return this.create({title:null,body:null,config:s(s({},n),{html:t})})},e.ctorParameters=function(){return[{type:void 0,decorators:[{type:n.Inject,args:["SnotifyToastConfig"]}]}]},r([a,u],e.prototype,"simple",null),r([a,u],e.prototype,"success",null),r([a,u],e.prototype,"error",null),r([a,u],e.prototype,"info",null),r([a,u],e.prototype,"warning",null),r([a,u],e.prototype,"confirm",null),r([a,u],e.prototype,"prompt",null),r([a,u],e.prototype,"async",null),e=r([n.Injectable(),(i=0,c=n.Inject("SnotifyToastConfig"),function(t,n){c(t,n,i)})],e)}(),h=function(){function t(t){this.service=t}return t.prototype.remove=function(){this.service.remove(this.toast.id)},t.ctorParameters=function(){return[{type:y}]},r([n.Input()],t.prototype,"toast",void 0),t=r([n.Component({selector:"ng-snotify-button",template:'<div class="snotifyToast__buttons">\r\n  <button\r\n    type="button"\r\n    *ngFor="let button of toast.config.buttons"\r\n    [ngClass]="{ \'snotifyToast__buttons--bold\': button.bold }"\r\n    (click)="button.action ? button.action(toast) : remove()"\r\n  >\r\n    {{ button.text }}\r\n  </button>\r\n</div>\r\n',changeDetection:n.ChangeDetectionStrategy.OnPush,encapsulation:n.ViewEncapsulation.None})],t)}(),g=function(){function t(){this.isPromptFocused=!1}return r([n.Input()],t.prototype,"toast",void 0),t=r([n.Component({selector:"ng-snotify-prompt",template:'<span class="snotifyToast__input" [ngClass]="{ \'snotifyToast__input--filled\': isPromptFocused }">\r\n  <input\r\n    (input)="toast.value = $event.target.value; toast.eventEmitter.next(\'input\')"\r\n    autofocus\r\n    class="snotifyToast__input__field"\r\n    type="text"\r\n    [id]="toast.id"\r\n    (focus)="isPromptFocused = true"\r\n    (blur)="isPromptFocused = !!toast.value.length"\r\n  />\r\n  <label class="snotifyToast__input__label" [for]="toast.id">\r\n    <span class="snotifyToast__input__labelContent">{{ toast.config.placeholder | truncate }}</span>\r\n  </label>\r\n</span>\r\n',changeDetection:n.ChangeDetectionStrategy.OnPush,encapsulation:n.ViewEncapsulation.None})],t)}();(l=t.SnotifyPosition||(t.SnotifyPosition={})).leftTop="leftTop",l.leftCenter="leftCenter",l.leftBottom="leftBottom",l.rightTop="rightTop",l.rightCenter="rightCenter",l.rightBottom="rightBottom",l.centerTop="centerTop",l.centerCenter="centerCenter",l.centerBottom="centerBottom";var m,d=function(){function o(t){this.service=t,this.backdrop=-1}return o.prototype.ngOnInit=function(){var t=this;this.emitter=this.service.emitter.subscribe((function(n){t.service.config.global.newOnTop?(t.dockSizeA=-t.service.config.global.maxOnScreen,t.dockSizeB=void 0,t.blockSizeA=-t.service.config.global.maxAtPosition,t.blockSizeB=void 0,t.withBackdrop=n.filter((function(t){return t.config.backdrop>=0}))):(t.dockSizeA=0,t.dockSizeB=t.service.config.global.maxOnScreen,t.blockSizeA=0,t.blockSizeB=t.service.config.global.maxAtPosition,t.withBackdrop=n.filter((function(t){return t.config.backdrop>=0})).reverse()),t.notifications=t.splitToasts(n.slice(t.dockSizeA,t.dockSizeB)),t.stateChanged("mounted")}))},o.prototype.stateChanged=function(t){if(this.withBackdrop.length)switch(t){case"mounted":this.backdrop<0&&(this.backdrop=0);break;case"beforeShow":this.backdrop=this.withBackdrop[this.withBackdrop.length-1].config.backdrop;break;case"beforeHide":1===this.withBackdrop.length&&(this.backdrop=0);break;case"hidden":1===this.withBackdrop.length&&(this.backdrop=-1)}else this.backdrop>=0&&(this.backdrop=-1)},o.prototype.splitToasts=function(n){var o={};for(var e in t.SnotifyPosition)t.SnotifyPosition.hasOwnProperty(e)&&(o[t.SnotifyPosition[e]]=[]);return n.forEach((function(t){o[t.config.position].push(t)})),o},o.prototype.ngOnDestroy=function(){this.emitter.unsubscribe()},o.ctorParameters=function(){return[{type:y}]},o=r([n.Component({selector:"ng-snotify",template:'<div class="snotify-backdrop" *ngIf="backdrop >= 0" [style.opacity]="backdrop"></div>\r\n<div *ngFor="let position of notifications | keys" class="snotify snotify-{{ position }}">\r\n  <ng-snotify-toast\r\n    *ngFor="let notification of notifications[position] | slice: blockSizeA:blockSizeB"\r\n    [toast]="notification"\r\n    (stateChanged)="stateChanged($event)"\r\n  >\r\n  </ng-snotify-toast>\r\n</div>\r\n',encapsulation:n.ViewEncapsulation.None})],o)}(),b=function(){function o(o){this.service=o,this.stateChanged=new n.EventEmitter,this.state={paused:!1,progress:0,animation:"",isDestroying:!1,promptType:t.SnotifyStyle.prompt}}return o.prototype.ngOnInit=function(){var t=this;this.toastChangedSubscription=this.service.toastChanged.subscribe((function(n){t.toast.id===n.id&&t.initToast()})),this.toastDeletedSubscription=this.service.toastDeleted.subscribe((function(n){t.toast.id===n&&t.onRemove()})),this.toast.config.timeout||(this.toast.config.showProgressBar=!1),this.toast.eventEmitter.next("mounted"),this.state.animation="snotifyToast--in"},o.prototype.ngAfterContentInit=function(){var t=this;setTimeout((function(){t.stateChanged.emit("beforeShow"),t.toast.eventEmitter.next("beforeShow"),t.state.animation=t.toast.config.animation.enter}),this.service.config.toast.animation.time/5)},o.prototype.ngOnDestroy=function(){cancelAnimationFrame(this.animationFrame),this.toast.eventEmitter.next("destroyed"),this.toastChangedSubscription.unsubscribe(),this.toastDeletedSubscription.unsubscribe()},o.prototype.onClick=function(){this.toast.eventEmitter.next("click"),this.toast.config.closeOnClick&&this.service.remove(this.toast.id)},o.prototype.onRemove=function(){var t=this;this.state.isDestroying=!0,this.toast.eventEmitter.next("beforeHide"),this.stateChanged.emit("beforeHide"),this.state.animation=this.toast.config.animation.exit,setTimeout((function(){t.stateChanged.emit("hidden"),t.state.animation="snotifyToast--out",t.toast.eventEmitter.next("hidden"),setTimeout((function(){return t.service.remove(t.toast.id,!0)}),t.toast.config.animation.time/2)}),this.toast.config.animation.time/2)},o.prototype.onMouseEnter=function(){this.toast.eventEmitter.next("mouseenter"),this.toast.config.pauseOnHover&&(this.state.paused=!0)},o.prototype.onMouseLeave=function(){this.toast.config.pauseOnHover&&this.toast.config.timeout&&(this.state.paused=!1,this.startTimeout(this.toast.config.timeout*this.state.progress)),this.toast.eventEmitter.next("mouseleave")},o.prototype.onExitTransitionEnd=function(){this.state.isDestroying||(this.initToast(),this.toast.eventEmitter.next("shown"))},o.prototype.initToast=function(){this.toast.config.timeout>0&&this.startTimeout(0)},o.prototype.startTimeout=function(t){var n=this;void 0===t&&(t=0);var o=performance.now(),e=function(){n.animationFrame=requestAnimationFrame((function(i){var s=i+t-o,r=Math.min(s/n.toast.config.timeout,1);n.state.paused?cancelAnimationFrame(n.animationFrame):s<n.toast.config.timeout?(n.state.progress=r,e()):(n.state.progress=1,cancelAnimationFrame(n.animationFrame),n.service.remove(n.toast.id))}))};e()},o.ctorParameters=function(){return[{type:y}]},r([n.Input()],o.prototype,"toast",void 0),r([n.Output()],o.prototype,"stateChanged",void 0),o=r([n.Component({selector:"ng-snotify-toast",template:'<div\r\n  [attr.role]="toast.config.type === state.promptType ? \'dialog\' : \'alert\'"\r\n  [attr.aria-labelledby]="\'snotify_\' + toast.id"\r\n  [attr.aria-modal]="toast.config.type === state.promptType"\r\n  [ngClass]="[\r\n    \'snotifyToast animated\',\r\n    \'snotify-\' + toast.config.type,\r\n    state.animation,\r\n    toast.valid === undefined ? \'\' : toast.valid ? \'snotifyToast--valid\' : \'snotifyToast--invalid\'\r\n  ]"\r\n  [ngStyle]="{\r\n    \'-webkit-transition\': toast.config.animation.time + \'ms\',\r\n    transition: toast.config.animation.time + \'ms\',\r\n    \'-webkit-animation-duration\': toast.config.animation.time + \'ms\',\r\n    \'animation-duration\': toast.config.animation.time + \'ms\'\r\n  }"\r\n  (animationend)="onExitTransitionEnd()"\r\n  (click)="onClick()"\r\n  (mouseenter)="onMouseEnter()"\r\n  (mouseleave)="onMouseLeave()"\r\n>\r\n  <div class="snotifyToast__progressBar" *ngIf="toast.config.showProgressBar">\r\n    <span class="snotifyToast__progressBar__percentage" [ngStyle]="{ width: state.progress * 100 + \'%\' }"></span>\r\n  </div>\r\n  <div class="snotifyToast__inner" *ngIf="!toast.config.html; else toastHTML">\r\n    <div class="snotifyToast__title" [attr.id]="\'snotify_\' + toast.id" *ngIf="toast.title">\r\n      {{ toast.title | truncate: toast.config.titleMaxLength }}\r\n    </div>\r\n    <div class="snotifyToast__body" *ngIf="toast.body">{{ toast.body | truncate: toast.config.bodyMaxLength }}</div>\r\n    <ng-snotify-prompt *ngIf="toast.config.type === state.promptType" [toast]="toast"> </ng-snotify-prompt>\r\n    <div\r\n      *ngIf="!toast.config.icon; else elseBlock"\r\n      [ngClass]="[\'snotify-icon\', toast.config.iconClass || \'snotify-icon--\' + toast.config.type]"\r\n    ></div>\r\n    <ng-template #elseBlock>\r\n      <img class="snotify-icon" [src]="toast.config.icon" />\r\n    </ng-template>\r\n  </div>\r\n  <ng-template #toastHTML>\r\n    <div class="snotifyToast__inner" [innerHTML]="toast.config.html"></div>\r\n  </ng-template>\r\n  <ng-snotify-button *ngIf="toast.config.buttons" [toast]="toast"></ng-snotify-button>\r\n</div>\r\n',encapsulation:n.ViewEncapsulation.None})],o)}(),v=function(){function t(){}return t.prototype.transform=function(t,n){return void 0===n&&(n=null),t?Object.keys(t):t},t=r([n.Pipe({name:"keys",pure:!1})],t)}(),S=function(){function t(){}return t.prototype.transform=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var e=40,i="...";return n.length>0&&(e=n.length>0?parseInt(n[0],10):e,i=n.length>1?n[1]:i),t.length>e?t.substring(0,e)+i:t},t=r([n.Pipe({name:"truncate"})],t)}(),T=function(){function t(){}var o;return o=t,t.forRoot=function(){return{ngModule:o,providers:[y]}},t=o=r([n.NgModule({imports:[e.CommonModule],declarations:[d,b,S,h,g,v],exports:[d,S,v]})],t)}(),k={global:{newOnTop:!0,maxOnScreen:8,maxAtPosition:8,filterDuplicates:!1},toast:{type:t.SnotifyStyle.simple,showProgressBar:!0,timeout:2e3,closeOnClick:!0,pauseOnHover:!0,bodyMaxLength:150,titleMaxLength:16,backdrop:-1,icon:null,iconClass:null,html:null,position:t.SnotifyPosition.rightBottom,animation:{enter:"fadeIn",exit:"fadeOut",time:400}},type:(m={},m[t.SnotifyStyle.prompt]={timeout:0,closeOnClick:!1,buttons:[{text:"Ok",action:null,bold:!0},{text:"Cancel",action:null,bold:!1}],placeholder:"Enter answer here...",type:t.SnotifyStyle.prompt},m[t.SnotifyStyle.confirm]={timeout:0,closeOnClick:!1,buttons:[{text:"Ok",action:null,bold:!0},{text:"Cancel",action:null,bold:!1}],type:t.SnotifyStyle.confirm},m[t.SnotifyStyle.simple]={type:t.SnotifyStyle.simple},m[t.SnotifyStyle.success]={type:t.SnotifyStyle.success},m[t.SnotifyStyle.error]={type:t.SnotifyStyle.error},m[t.SnotifyStyle.warning]={type:t.SnotifyStyle.warning},m[t.SnotifyStyle.info]={type:t.SnotifyStyle.info},m[t.SnotifyStyle.async]={pauseOnHover:!1,closeOnClick:!1,timeout:0,showProgressBar:!1,type:t.SnotifyStyle.async},m)};t.ButtonsComponent=h,t.KeysPipe=v,t.PromptComponent=g,t.SnotifyComponent=d,t.SnotifyModule=T,t.SnotifyService=y,t.SnotifyToast=p,t.ToastComponent=b,t.ToastDefaults=k,t.TruncatePipe=S,t.ɵa=d,t.ɵb=y,t.ɵd=a,t.ɵe=u,t.ɵf=b,t.ɵg=S,t.ɵh=h,t.ɵi=g,t.ɵj=v,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ng-snotify.umd.min.js.map